<?php defined('BLUDIT') or die('Bludit CMS.');

// ============================================================================
// Check role
// ============================================================================

checkRole(array('admin'));

// ============================================================================
// Functions
// ============================================================================

// ============================================================================
// Main before POST
// ============================================================================
if ($_SERVER['REQUEST_METHOD'] == 'POST') {
	// CSRF Token 验证
	if (!isset($_POST['tokenCSRF']) || !$security->validateTokenCSRF($_POST['tokenCSRF'])) {
		Alert::set($L->g('Invalid security token'), ALERT_STATUS_FAIL);
		Redirect::page('plugins-position');
	}
	
	changePluginsPosition(explode(',',$_POST['plugin-list']));
	Redirect::page('plugins-position');
}
// ============================================================================
// POST Method
// ============================================================================

// ============================================================================
// Main after POST
// ============================================================================

// Title of the page
$layout['title'] .= ' - '.$L->g('Plugins');